jQuery.fn.bindFirst=function(a,b){this.bind(a,b);var c=this.data("events")||jQuery._data(this[0],"events"),d=c[a],e=d.splice(d.length-1)[0];d.splice(0,0,e)};var Rainmaker=function(){};Rainmaker.prototype={init:function(a){jQuery(a).closest(".rainmaker_form").length<1||jQuery(a).closest(".rainmaker_form").hasClass("rm_init_done")||(jQuery(a).find(".rm_required_field, .ig_form_required_field").length<1&&jQuery(a).append('<div style="position:absolute; left: -5000px"><input type="text" class="rm_required_field" value="" tabindex="-1"/></div>'),jQuery(a).closest(".rainmaker_form").addClass(jQuery(a).closest(".rainmaker_form").data("type")||""),jQuery(a).bindFirst("submit",function(a){window.rainmaker.addLead(a,jQuery(a.target))}),jQuery(a).closest(".rainmaker_form").addClass("rm_init_done"))},addLead:function(a,b,c){var b=b||void 0;if("undefined"!=typeof b){if(jQuery(b).closest(".rainmaker_form").length<1)return;var c=c||void 0,d=b.closest(".rainmaker_form");jQuery(d).find(".rm-loader").show(),jQuery(d).find(".rm_button").attr("disabled",!0);var e=jQuery(b).find('input[name="_mc4wp_form_id"]')&&jQuery(b).find('input[name="_mc4wp_form_id"]').length>0;if(jQuery(d).hasClass("rm_custom")&&(jQuery(b).attr("action")||e)||a.preventDefault(),jQuery(b).find(".rm_required_field").val()||jQuery(b).find(".ig_form_required_field").val())return jQuery(d).find(".rm-loader").hide(),b.slideUp("slow"),void jQuery(d).find("div.rm_form_message").show();var f={},f=window.rainmaker.prepareFormData(a,b,c,f);action=rm_pre_data.ajax_url+"?action=rm_rainmaker_add_lead",jQuery(b).trigger("add_lead.rm",[f]),jQuery.ajax({type:"POST",url:action,data:f,dataType:"json",success:function(a){if(a&&"undefined"!=typeof a.error&&""!==a.error)jQuery(d).find(".rm-loader").hide(),jQuery(window).trigger("error.rm",[b,a]);else if(a&&"undefined"!=typeof a.success){jQuery(b)[0].reset(),jQuery(b).trigger("success.rm",[b,a]),jQuery(d).find(".rm-loader").hide(),""!==jQuery.trim(jQuery(d).next("div.rm_form_message").html())&&(jQuery(d).slideUp("slow"),jQuery(d).next("div.rm_form_message").show());var c=a.redirection_url||"";c=c.trim(),"string"==typeof c&&""!=c&&(/^https?:\/\//i.test(c)||(c="http://"+c),setTimeout(function(){window.location.href=c},200))}else jQuery(d).find(".rm-loader").hide()},error:function(a){jQuery(d).find(".rm-loader").hide(),console.log(a)}})}},prepareFormData:function(a,b,c,d){if(jQuery.each(jQuery(b).serializeArray()||{},function(a,b){d["rmfpx_"+b.name]=b.value}),d.rmfpx_added=!0,d.rmfpx_rm_nonce_field=rm_pre_data.rm_nonce_field,d["rmfpx_rm_form-id"]=jQuery(b.closest(".rainmaker_form")).data("form-id"),"undefined"!=typeof icegram){if(d.rmfpx_ig_mode=icegram.mode,d.rmfpx_ig_remote_url=window.location.href,"undefined"==typeof c){var e=(jQuery(b.closest("[id^=icegram_message_]")||{}).attr("id")||"").split("_").pop()||0;c=icegram.get_message_by_id(e)||{}}"undefined"!=typeof c.data&&(d.rmfpx_ig_message_id=c.data.id,d.rmfpx_ig_campaign_id=c.data.campaign_id)}return d}},"undefined"==typeof window.rainmaker&&(window.rainmaker=new Rainmaker),jQuery(document).ready(function(){jQuery(".rainmaker_form form").each(function(a,b){window.rainmaker.init(b)})}),jQuery(window).on("init.icegram",function(a,b){"undefined"!=typeof b&&"undefined"!=typeof b.messages&&jQuery.each(b.messages,function(a,b){var c=jQuery(b.el).find(".rainmaker_form form");c.each(function(a,b){jQuery(b).hasClass("rm_init_done")||(window.rainmaker.init(b),jQuery(b).addClass("rm_init_done"))})})}),jQuery(window).off("success.rm"),jQuery(window).on("success.rm",function(a,b,c){if("undefined"!=typeof icegram){var d=((jQuery(a.target).closest("[id^=icegram_message_]")||{}).attr("id")||"").split("_").pop()||0,e=icegram.get_message_by_id(d)||void 0;if("undefined"!=typeof e)if("form_via_ajax"===e.data.cta&&e.el.find(".rm_subscription, .rm_contact").length>0)e.el.trigger("form_success.ig_cta",[e]);else if("form"===e.data.cta||!e.data.cta){void 0==e.data.use_form&&(e.data.response_text=""),response_text='<div class="ig_form_response_text">'+(e.data.response_text||e.el.find(".rm_form_message").html()||"")+"</div>",e.el.find(".ig_form_container, .ig_message, .ig_headline").hide();var f=e.el.filter(".ig_container");-1!==jQuery.inArray(e.data.type,["interstitial","messenger"])?(f=e.el.find(".ig_message"),f.show(),e.el.find(".ig_headline").text("").show()):"tab"===e.data.type&&(f=e.el.find(".ig_data"),e.el.find(".ig_headline").show());try{f.append(response_text)}catch(g){console.log(g)}}}}),jQuery(window).off("form_submit.ig_cta"),jQuery(window).on("form_submit.ig_cta",window.rainmaker.addLead);